<!DOCTYPE html>
<html>
    <head>
        <h1>
            This is the Manager for the websocket sandbox
        </h1>
        <p>
            Send a message to all of the clients
        </p>
        <p id = "response">This should be "Socket open"</p>
        <p id = "payload"> Current Payload </p>
        <input type="text" id="message" name="fname">
        <button onclick="dispatchMessage()">Submit</button>
        <script>

            let socket = new WebSocket("wss://2vbwss9q2g.execute-api.us-east-1.amazonaws.com/default")
            socket.onopen = function(e) {
                var response = document.getElementById("response")
                response.innerHTML = "Socket open"
                console.log("Opened socket")
            }
            
            function dispatchMessage() {
                const message = document.getElementById("message").innerHTML
                console.log("trying to send event")
                socket.send({
                    action:"default",
                    message:message
                })
             }
             
             socket.onmessage = function(e) {
                var response = document.getElementById("response")
                response.innerHTML = "Message delivered"
                console.log("message received")
            }
            document.getElementById.innerHTML = socket.bufferedAmount
        </script>
    </head>
    
</html>